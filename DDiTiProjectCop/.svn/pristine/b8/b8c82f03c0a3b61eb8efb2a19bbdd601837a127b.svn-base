<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>

<div class="container-full">
	<!-- Content Header (Page header) -->
	<div class="content-header">
		<div class="d-flex align-items-center">
			<div class="me-auto">
				<h3 class="page-title">학사일정</h3>
				<div class="d-inline-block align-items-center">
					<nav>
						<ol class="breadcrumb">
							<li class="breadcrumb-item"><a href="#"><i
									class="mdi mdi-home-outline"></i></a></li>
							<li class="breadcrumb-item" aria-current="page">관리 정보</li>
							<li class="breadcrumb-item active" aria-current="page">학사일정</li>
						</ol>
					</nav>
				</div>
			</div>
		</div>
	</div>

	<!-- Main content -->
	<section class="content">
		<div class="row">
			<!-- 일정 캘린더 -->
			<div class="col-xl-12 col-lg-12 col-12">
				<div class="box">
					<div class="box-body">
						<div id="calendar"></div>
					</div>
				</div>
			</div>
			<!-- 일정 목록 -->
			<div class="col-xl-12 col-lg-12 col-12">
				<div class="box no-border no-shadow">
					<div class="box-header with-border">
						<h4 class="box-title">Events</h4>
					</div>
					<div class="box-body p-20">
						<div class="row">
							<div class="col-lg-6 col-12">
								<button onclick="" data-bs-toggle="modal" data-bs-target="#add-new-events" class="btn btn-success bg-primary">
									<i class="ti-plus"></i> Add New Event
								</button>
							</div>
							<div class="text-end col-lg-6 col-12">
								<div class="lookup lookup-circle lookup-right">
									<input type="text" data-provide="media-search" placeholder="Search">
								</div>
							</div>
							<div class="table-responsive p-10">
								<table class="table mb-0 b-1 border-primary"
									style="text-align: center">
									<thead class="bg-primary">
										<tr>
											<th scope="col">번호</th>
											<th scope="col">학사일정</th>
											<th scope="col">학기</th>
											<th scope="col">시작일자</th>
											<th scope="col">종료일자</th>
											<th scope="col">등록자</th>
										</tr>
									</thead>
									<tbody>
										<c:forEach items="${univSchedule }" var="list">
											<c:choose>
												<c:when test="${empty list }">
													<tr>
														<td colspan="5">생성된 일정이 없습니다.</td>
													</tr>
												</c:when>
												<c:otherwise>
													<tr>
														<td>${list.univSchNo }</td>
														<td>${list.univSchName }</td>
														<td>${list.univSchSem }</td>
														<td>${list.univSchStartDate }</td>
														<td>${list.univSchEndDate }</td>
														<td>${list.univSchReg }</td>
													</tr>
												</c:otherwise>
											</c:choose>
										</c:forEach>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- 일정 목록 -->
		</div>
	</section>
</div>



<!-- BEGIN MODAL -->
<div class="modal fade none-border" id="add-new-events">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">
					<strong>Add</strong> schedule
				</h4>
				<button type="button" class="btn-close" data-bs-dismiss="modal"
					aria-label="Close"></button>
			</div>
			<form action="/employer/addSchedule.do" method="post" id="scheduleForm">
				<div class="modal-body">
					<div class="form-body">
						<div class="row">
							<div class="col-md-12">
								<div class="form-group">
									<label class="fw-700 fs-16 form-label" for="scheduleTitle">제목</label>
									<input type="text" class="form-control" id="scheduleTitle" name="scheduleTitle">
								</div>
							</div>
						</div>
						<div class="col-md-12">
							<div class="form-group">
								<label class="fw-700 fs-16 form-label">일정 설명</label>
								<textarea class="form-control p-15" rows="4" id="scheduleCont" name="scheduleCont"></textarea>
							</div>
						</div>
						<div class="row">
							<div class="col-md-6">
								<div class="form-group">
									<label class="form-label">해당 학기</label> <select
										class="form-select" id="currentSem" name="currentSem">
										<option value="none">현재학기</option>
										<option value="#학기">2023년 2학기</option>
										<option value="#학기">2023년 1학기</option>
									</select>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="form-group row">
								<label class="col-form-label col-md-2">시작일자</label>
								<div class="col-md-10">
									<input class="form-control" type="date" name="month" id="sdate" name="sdate" value=''>
								</div>
								<label class="col-form-label col-md-2">종료일자</label>
								<div class="col-md-10">
									<input class="form-control" type="date" name="month" id="edate" name="edate">
								</div>
								
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-success save-category"
						data-bs-dismiss="modal" id="addBtn">Save</button>
					<button type="button" class="btn btn-danger"
						data-bs-dismiss="modal">Close</button>
				</div>
<!-- 				<input type="hidden" name="univSchReg" id="univSchReg" /> -->
			</form>
		</div>
	</div>
</div>
<!-- END MODAL -->


<script>
	var calendarType = "month";
</script>
<c:if test="${not empty message }">
	<script type="text/javascript">
		alert("${message }");
		<c:remove var="message" scope="request"/>
		<c:remove var="message" scope="session"/>
	</script>
</c:if>


<!-- Vendor JS -->
<script src="${pageContext.request.contextPath}/resources/assets/vendor_components/perfect-scrollbar-master/perfect-scrollbar.jquery.min.js"></script>
<script src='fullcalendar/dist/index.global.js'></script>


<script>
function f_newEventCustom() {

}

function f_calendarClickEvent(start, end, allDay) {
	console.log(start, end, allDay);

	/* 시작일 */
	var syear = start.year();
	var smonth = start.month();
	if(start.month() <= 8){
		smonth = "0" + (start.month()+1);
	}
	var sdate = start.date();
	if(start.date() <= 8){
		sdate = "0" + (start.date());
	}	
		
	/* 종료일 */
	var eyear = end.year();
	var emonth = end.month();
	if(end.month() <= 8){
		emonth = "0" + (end.month()+1);
	}
	var edate = end.date();
	if(end.date() <= 8){
		edate = "0" + (end.date()-1);
	}else{
		edate = (end.date()-1);
	}	
	
	/* 시작,종료일 적용 */
	var startDate = syear+ "-" + smonth + "-" + sdate;
	console.log(startDate);
	$("#sdate").val(startDate);
	
	var endDate = eyear+ "-" + emonth + "-" + edate;
	console.log(endDate);
	$("#edate").val(endDate);
	
	
	/* var endDate = end.date(); */
	
	var addevents = $("#add-new-events");
		addevents.modal('show');
	}
	
	
	
	
$(function() {
	console.log("캘린더");
	
 	var scheduleForm = $("#scheduleForm"); // 일정 등록 From
	var addBtn = $("#addBtn"); // 일정 등록 버튼 Element

	addBtn.on("click", function() {
		console.log("일정 등록")
		var scheduleTitle = $("#scheduleTitle").val(); // 제목
		var scheduleCont = $("#scheduleCont").val(); // 내용
		var currentSem = $("#currentSem option:checked").text();// 학기
		var startDate = $("#sdatetime").val(); // 시작일자
		var endDate = $("#edatetime").val(); // 종료일자
/* 		var univSchReg = $("#univSchReg").text(); // 등록자 */

		if (scheduleTitle == null || scheduleTitle == "") {
			alert("제목을 입력해주세요");
			$("#scheduleTitle").focus();
			return false;
		}

		/* univSchReg.innerHtml("관리자"); */
		scheduleForm.submit();
	});
});
</script>
