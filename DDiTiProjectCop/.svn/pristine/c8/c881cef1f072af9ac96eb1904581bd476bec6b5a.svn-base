<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="${pageContext.request.contextPath }/resources/images/favicon.ico">

    <title>EduAdmin - Log in </title>
  
	<!-- Vendors Style-->
	<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/vendors_css.css">
	  
	<!-- Style-->  
	<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/style.css">
	<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/css/skin_color.css">
	
	<!-- JQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
	
</head>
	
<body class="hold-transition theme-primary bg-img" style="background-image: url(${pageContext.request.contextPath }/resources/images/auth-bg/bg-1.jpg)">
	
	<div class="container h-p100">
		<div class="row align-items-center justify-content-md-center h-p100">	
			
			<div class="col-12">
				<div class="row justify-content-center g-0">
					<div class="col-lg-5 col-md-5 col-12">
						<div class="bg-white rounded10 shadow-lg">
							<div class="content-top-agile p-20 pb-0">
								<h2 class="text-primary">대육 대학교</h2>
								<h3 class="mb-0">로그인</h3>							
							</div>
							<div class="p-40">
								<form action="login.do" method="post" id="loginForm">
									<div class="form-group">
										<h4>학사/학번</h4>
										<%
											String id = (String)session.getAttribute("rememberId");
											String idRememberChecked = "";
											if(id != null){
												idRememberChecked = "checked";
											} else {
												id = "";
											}
										%>
										
										<div class="input-group mb-3">
											<span class="input-group-text bg-transparent"><i class="ti-id-badge"></i></span>
											<input type="text" class="form-control ps-15 bg-transparent" name="memId" id="memId" placeholder="" value="<%=id %>">
										</div>
									</div>
									<div class="form-group">
										<h4>비밀번호</h4>
										<div class="input-group mb-3">
											<span class="input-group-text  bg-transparent"><i class="ti-lock"></i></span>
											<input type="password" class="form-control ps-15 bg-transparent" name="memPw" id="memPw" placeholder="">
										</div>
									</div>
									  <div class="row">
										<div class="col-12">
										  <div class="checkbox">
											<input type="checkbox" name="idRememberCheckbox" id="basic_checkbox_1" <%=idRememberChecked %>>
											<label for="basic_checkbox_1">학사/학번 기억하기</label>
										  </div>
										</div>
										
									  <c:if test="${failCount eq null }">
									  	<c:set value="${0 }" var="failCount" />
									  </c:if>
									  <c:if test="${failCount >= 5 }">
									  	<div id="g-recaptcha"></div>
									  </c:if>
									  <input type="hidden" name="failCount" value="${failCount }">
									  
									  
								  </div>
								</form>	
								<!-- /.col -->
								<div class="col-12 text-center">
								  <button type="button" class="btn btn-danger mt-10" onclick="f_login()" id="loginBtn">LOG IN</button>
								</div>
								<!-- /.col -->
									
									<!-- /.col -->
							</div>						
						</div>
						<div class="text-center">
						  <p class="mt-20 text-white">아이디/비밀번호를 잊어버리셨나요?</p>
						  <p class="gap-items-2 mb-20">
							<a href="/findId.do" class="hover-warning"><i class="ion ion-locked"></i>아이디/비밀번호  찾기</a><br>
						  </p>	
						</div>
						<div class="text-center">
							<button class="btn btn-info btn-xl" onclick="f_std()">학생용</button>
							<button class="btn btn-info btn-xl" onclick="f_pro()">교수용</button>
							<button class="btn btn-info btn-xl" onclick="f_emp()">직원용</button>
							<button class="btn btn-info btn-xl" onclick="f_t1()">테스트용1</button>
							
							<script type="text/javascript">
								function f_std() {
									$("#memId").val("b001");
									$("#memPw").val("1234aa!@");
								}
								function f_pro() {
									$("#memId").val("d001");
									$("#memPw").val("1234aa!@");
								}
								function f_emp() {
									$("#memId").val("a001");
									$("#memPw").val("1234aa!@");
								}
								function f_t1() {
									$("#memId").val("h001");
									$("#memPw").val("pw");
								}
							</script>
						</div>
						
						<div class="text-center">
							<button class="btn btn-info btn-xl" onclick="f_tt1()">수강테스트1</button>
							<button class="btn btn-info btn-xl" onclick="f_tt2()">수강테스트2</button>
							<button class="btn btn-info btn-xl" onclick="f_tt3()">수강테스트3</button>
							<button class="btn btn-info btn-xl" onclick="f_tt4()">수강테스트4</button>
							<button class="btn btn-info btn-xl" onclick="f_tt5()">민젼교수</button>
							<button class="btn btn-info btn-xl" onclick="f_tt6()">민젼학생</button>
							
							<script type="text/javascript">
								function f_tt1() {
									$("#memId").val("24010135");
									$("#memPw").val("java");
								}
								function f_tt2() {
									$("#memId").val("24010136");
									$("#memPw").val("java");
								}
								function f_tt3() {
									$("#memId").val("24010137");
									$("#memPw").val("java");
								}
								function f_tt4() {
									$("#memId").val("24010138");
									$("#memPw").val("java");
								}
								function f_tt5() {
									$("#memId").val("24000238");
									$("#memPw").val("java");
								}
								function f_tt6() {
									$("#memId").val("20102417");
									$("#memPw").val("java");
								}
							</script>
							
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	

	<c:if test="${failCount >= 5 }">
		<!--  -->
		<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
		<script type="text/javascript">
		
		$("#loginBtn").addClass("disabled-btn");
		$("#loginBtn").attr("disabled", "disabled");
		
		//화면 시작 시 g-recaptcha 생성
		var onloadCallback = function() {
			grecaptcha.render('g-recaptcha', {
			'sitekey' : '6LdprUopAAAAAPmw1c6JkWc7FY_OmNf7BhRuMbEh', //인증용 사이트키
			'callback' : verifyCallback,
			'expired-callback' : expiredCallback,
			});
		};
		// 인증 성공 시
		var verifyCallback = function(response) {
			console.log("g-recaptcha success...");
			$("#loginBtn").removeClass("disabled-btn");
			$("#loginBtn").removeAttr("disabled");
		};
		// 인증 만료 시
		var expiredCallback = function(response) {
			console.log("g-recaptcha failed...");
			$("#loginBtn").addClass("disabled-btn");
			$("#loginBtn").attr("disabled", "disabled");
		}
		// g-recaptcha 리셋
		var resetCallback = function() {
			grecaptcha.reset();
		}
		</script>
	</c:if>

</body>
<!-- Vendor JS -->
<script src="${pageContext.request.contextPath }/resources/js/vendors.min.js"></script>
<script src="${pageContext.request.contextPath }/resources/js/pages/chat-popup.js"></script>
<script src="${pageContext.request.contextPath }/resources/assets/icons/feather-icons/feather.min.js"></script>	
<script type="text/javascript">

$(function(){
	$("#memPw").keydown(function(e) {
		console.log(e.keyCode);
		if(e.keyCode == 13){
			f_login();
		}
	})
})

var loginForm = $("#loginForm");

function f_login(){

	var memId = $("#memId").val();
	var memPw = $("#memPw").val();
	//console.log("test", $("#memId").val());
	//console.log("test", $("#memPw").val());

	if(memId == null || memId == ""){
		alert("아이디를 입력");
		return false;
	}
	
	if(memPw == null || memPw == ""){
		alert("비밀번호를 입력");
		return false;
	}

	loginForm.submit();

}



</script>
</html>
